## 상호배제 (Mutual Exclusion) 알고리즘

#### 데커 (Dekker)
flag, turn 변수를 통해 임계 구역에 임계구역에 진입할 프로세스 (또는 쓰레드) 를 결정하는 알고리즘.

> flag : 어떤 프로세스가 임계구역에 진입할 것인지 나타내는 변수
> 
> turn : 어떤 프로세스가 임계구역에 들어갈 차례인지 나타내는 변수

```sql

while(true) {
    flag[i] = true;              // 프로세스 i가 임계 구역 진입 시도

    while(flag[j]) {             // 프로세스 j가 현재 임계 구역에 있는지 확인

        if(turn == j) {          // j가 임계 구역 사용 중이면
            flag[i] = false;     // 프로세스 i 진입을 취소

            while(turn == j) {}; // turn이 j에서 변경될 때까지 대기
            flag[i] = true;      // 프로세스 j의 turn이 끝나면 다시 진입 시도
        }
    }
}

------- 임계 구역 ---------

turn = j;                        // 임계 구역 사용 끝나면 turn을 넘긴다.
flag[i] = false;                 // flag 값을 false로 바꿔 임계 구역 사용 완료를 알림

```

<br />

#### 피터슨 (Peterson)
데커와 유사하지만, 상대방 프로세스 (또는 쓰레드) 에게 진입 기회를 양보하는 것에 차이가 있다.

```sql

while(true) {
    flag[i] = true;                 // 프로세스 i가 임계 구역 진입 시도
    turn = j;                       // 다른 프로세스에게 진입 기회 양보 
                                    // (프로세스 j가 임계구역에 먼저 들어간다.)

    while(flag[j] && turn == j) {}; // 다른 프로세스가 진입 시도하면 대기
}

------- 임계 구역 ---------

flag[i] = false;                    // flag 값을 false로 바꿔 임계 구역 사용 완료를 알림

```

<br />

#### Lamport의 제과점 (Bakery)
여러 프로세스 (또는 쓰레드) 에 대한 처리가 가능하기 때문에 분산 처리 환경에 유용한 알고리즘.

번호표를 부여하고, 가장 작은 수의 번호표를 가지고 있는 프로세스가 임계 구역에 진입한다.
> 반드시 들어온 순서대로 수행되어야 하는 것은 아니다.

```sql

while(true) {
    
    choosing[i] = true;                    // 번호표 받을 준비
    number[i] = max(number[0 ~ n-1]) + 1;  // 다음 번호를 생성하여 할당
    choosing[i] = false;                   // 번호표 수령 완료
    
    for(j = 0; j < n; j++) {               // 모든 프로세스 번호표 비교
        while(choosing[j]) {};             // 비교 프로세스가 번호표 받을 때까지 대기
        while(number[j] && number[j] < number[i] && j < i) {};
        
        // 프로세스 j가 번호표를 가지고 있고
        // 프로세스 j의 번호표가 프로세스 i의 번호표보다 작을 때,
        // 또는 프로세스 번호표가 동일한 경우, 
        // 프로세스 고유번호인 j와 i를 비교하여 j가 i보다 작을 때,
        // 프로세스 j가 종료 (number[j] = 0) 할 때 까지 대기
    }
}

------- 임계 구역 ---------

number[i] = 0; // 임계 구역 사용 종료

```